/**
 * Course recommender AMD module.
 *
 * @module     block_course_recommender/recommender
 * @copyright  2025 Sadik Mert
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_course_recommender/recommender",["jquery","core/ajax","core/notification","core/str"],(function($,Ajax,Notification,Str){return{init:function(){var form=$("#courserecommender-form"),resultsContainer=$(".courserecommender-results");if(form.length&&resultsContainer.length){var tagsContainer=form.find(".courserecommender-tags-container"),badges=tagsContainer.find(".courserecommender-badge"),maxtags=parseInt(tagsContainer.data("maxtags"),10);if(maxtags>0&&badges.length>maxtags){badges.each((function(idx){idx>=maxtags&&$(this).hide()}));var showAllBtn=tagsContainer.find(".show-all-tags-btn");showAllBtn.show(),showAllBtn.on("click",(function(){badges.show(),$(this).hide()}))}form.on("click",".courserecommender-badge",(function(e){e.preventDefault(),$(this).toggleClass("selected"),function(form){var selected=[];form.find(".courserecommender-badge.selected").each((function(){selected.push($(this).data("tag"))})),form.find("#courserecommender-selected-tags").val(selected.join(","))}(form),clearTimeout(window.changeTimeout),window.changeTimeout=setTimeout((function(){form.submit()}),300)})),form.on("submit",(function(e){e.preventDefault(),function(form,resultsContainer){resultsContainer.html('<div class="text-center"><span class="spinner-border"></span></div>');var interests=form.find("#courserecommender-selected-tags").val(),request={methodname:"block_course_recommender_get_courses",args:{interests:interests=interests?interests.split(","):[],sesskey:M.cfg.sesskey}};Ajax.call([request])[0].done((function(response){resultsContainer.fadeOut(200,(function(){$(this).html(response.html).fadeIn(200)}))})).fail((function(error){Notification.exception(error),function(resultsContainer){Str.get_string("error","block_course_recommender").then((function(errorStr){return resultsContainer.html('<div class="alert alert-danger">'+errorStr+"</div>"),null})).catch((function(){return resultsContainer.html('<div class="alert alert-danger">Error</div>'),null}))}(resultsContainer)}))}(form,resultsContainer)}))}}}}));

//# sourceMappingURL=recommender.min.js.map